---
import Shape from "@/components/Shape.astro";
import config from "@/config/config.json";
import Base from "@/layouts/Base.astro";
import { getTaxonomy } from "@/lib/taxonomyParser.astro";
import courseInfo from "@/data/course-info.json";

const { blog_folder } = config.settings;
const courses = await getTaxonomy(blog_folder, "courses");
---

<Base title={"courses"}>
  <Shape />
  <section class="page-hero pb-14 pt-16">
    <div class="container">
      <div class="mx-auto max-w-3xl text-center mb-12">
        <h1 class="mb-4 text-3xl font-bold">Course Collection</h1>
        <p class="text-lg text-gray-600 mb-8">
          Explore curated collection of courses designed to boost your skills across software development, algorithms, and system design. Dive in below to find detailed course materials and track your progress along the way.
        </p>
        
        <!-- Course Stats -->
        <div class="grid grid-cols-3 gap-4 max-w-2xl mx-auto mb-8">
          <div class="bg-blue-50 p-4 rounded-lg">
            <div class="text-2xl font-bold text-blue-600">6</div>
            <div class="text-sm text-gray-600">Categories</div>
          </div>
          <div class="bg-green-50 p-4 rounded-lg">
            <div class="text-2xl font-bold text-green-600">3</div>
            <div class="text-sm text-gray-600">In Focus</div>
          </div>
          <div class="bg-purple-50 p-4 rounded-lg">
            <div class="text-2xl font-bold text-purple-600">29+</div>
            <div class="text-sm text-gray-600">Courses</div>
          </div>
        </div>

        <!-- Timeline Button -->
        <button id="kanbanToggle" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg shadow-md transition-colors duration-300">
          View Course Completion Timeline
        </button>
      </div>
    </div>
  </section>

   <!-- Kanban Board Modal -->
   <div id="kanbanModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 overflow-auto">
    <div class="min-h-screen flex items-center justify-center p-4">
      <div class="bg-white rounded-lg shadow-xl w-full max-w-6xl max-h-[90vh] overflow-auto">
        <!-- Modal Header -->
        <div class="border-b p-4 flex justify-between items-center sticky top-0 bg-white">
          <h2 class="text-2xl font-bold text-gray-800">Course Completion Timeline</h2>
          <button id="closeKanban" class="text-gray-600 hover:text-gray-800">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
        </div>

        <!-- Kanban Board Content -->
        <div class="p-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          <!-- Development Section -->
          <div class="bg-gray-100 rounded-lg p-4">
            <div class="flex items-center gap-2 mb-4">
              <h3 class="text-lg font-bold text-gray-800">Development</h3>
              <span class="bg-blue-100 text-blue-800 text-xs font-medium px-2 py-1 rounded">in Focus</span>
            </div>
            <div class="space-y-2">
              <div class="bg-white p-3 rounded shadow">Fullstack Development</div>
              <div class="bg-white p-3 rounded shadow">JavaScript</div>
              <div class="bg-white p-3 rounded shadow">React Js</div>
              <div class="bg-white p-3 rounded shadow">Three JS</div>
              <div class="bg-white p-3 rounded shadow">UI Interview</div>
            </div>
          </div>

          <!-- Development++ Section -->
          <div class="bg-gray-100 rounded-lg p-4">
            <h3 class="text-lg font-bold text-gray-800 mb-4">Development++</h3>
            <div class="space-y-2">
              <div class="bg-white p-3 rounded shadow">GIT</div>
              <div class="bg-white p-3 rounded shadow">Distributed Systems</div>
              <div class="bg-white p-3 rounded shadow">AWS</div>
              <div class="bg-white p-3 rounded shadow">Databases Deep Dive</div>
              <div class="bg-white p-3 rounded shadow">Multi-Programming</div>
              <div class="bg-white p-3 rounded shadow">Microservices</div>
              <div class="bg-white p-3 rounded shadow">DevOps</div>
            </div>
          </div>

          <!-- DSA Section -->
          <div class="bg-gray-100 rounded-lg p-4">
            <div class="flex items-center gap-2 mb-4">
              <h3 class="text-lg font-bold text-gray-800">DSA</h3>
              <span class="bg-blue-100 text-blue-800 text-xs font-medium px-2 py-1 rounded">in Focus</span>
            </div>
            <div class="space-y-2">
              <div class="bg-white p-3 rounded shadow">Java</div>
              <div class="bg-white p-3 rounded shadow">DSA</div>
              <div class="bg-white p-3 rounded shadow">DSA style Interviews</div>
            </div>
          </div>

          <!-- Core CS Section -->
          <div class="bg-gray-100 rounded-lg p-4">
            <h3 class="text-lg font-bold text-gray-800 mb-4">Core CS</h3>
            <div class="space-y-2">
              <div class="bg-white p-3 rounded shadow">Operating System</div>
              <div class="bg-white p-3 rounded shadow">Computer Networks</div>
              <div class="bg-white p-3 rounded shadow">Databases</div>
              <div class="bg-white p-3 rounded shadow">Computer Arch</div>
              <div class="bg-white p-3 rounded shadow">Digital Electronics</div>
              <div class="bg-white p-3 rounded shadow">Compilers</div>
              <div class="bg-white p-3 rounded shadow">Discrete Math</div>
              <div class="bg-white p-3 rounded shadow">Automata Theory</div>
            </div>
          </div>

          <!-- Product Section -->
          <div class="bg-gray-100 rounded-lg p-4">
            <h3 class="text-lg font-bold text-gray-800 mb-4">Product</h3>
            <div class="space-y-2">
              <div class="bg-orange-400 p-3 rounded shadow text-white">UI/UX Design (In Progress) </div>
              <div class="bg-white p-3 rounded shadow">Product Management</div>
            </div>
          </div>

          <!-- System Design Section -->
          <div class="bg-gray-100 rounded-lg p-4">
           
            <div class="flex items-center gap-2 mb-4">
              <h3 class="text-lg font-bold text-gray-800">System Design</h3>
              <span class="bg-blue-100 text-blue-800 text-xs font-medium px-2 py-1 rounded">in Focus</span>
            </div>
            <div class="space-y-2">
              <div class="bg-white p-3 rounded shadow">API Design & Development</div>
              <div class="bg-white p-3 rounded shadow">System Design Foundations</div>
              <div class="bg-white p-3 rounded shadow">System Design in Depth</div>
              <div class="bg-white p-3 rounded shadow">Frontend System Design</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

  <section class="section">
    <div class="container">
      <h2 class="text-2xl font-bold text-center mb-8">Available Courses</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        {Object.entries(courseInfo).map(([slug, course]) => (
          <a href={`/courses/${slug}`} class="group relative card bg-white rounded-lg shadow-md p-4 hover:shadow-lg transition-shadow duration-300">
            <img src={course.image || "/images/collaboration.png"} alt={course.title} class="w-full h-48 object-cover rounded-md mb-4"/>
            
            <span class="inline-block bg-[#f7e26bd8] text-black text-xs font-semibold py-1 px-3 rounded-full mb-4">
              {course.category}
            </span>
            <span class="inline-block bg-[#fa729a] text-white text-xs font-semibold py-1 px-3 rounded-full mb-4">
              {course.time}
            </span>
            <h2 class="text-xl font-semibold text-gray-800">{course.title}</h2>
            <p class="text-gray-600 mt-2 mb-4">{course.description}</p>
            
            <div class="absolute inset-0 bg-black opacity-0 group-hover:opacity-20 transition-opacity duration-300 rounded-lg"></div>
          </a>
        ))}
      </div>
    </div>
  </section>
</Base>

<script is:inline>
  function initializeKanban() {
    const kanbanToggle = document.getElementById('kanbanToggle');
    const kanbanModal = document.getElementById('kanbanModal');
    const closeKanban = document.getElementById('closeKanban');

    if (kanbanToggle && kanbanModal && closeKanban) {
      // Remove existing event listeners
      kanbanToggle.removeEventListener('click', toggleModal);
      closeKanban.removeEventListener('click', closeModal);
      kanbanModal.removeEventListener('click', handleOutsideClick);

      // Add new event listeners
      kanbanToggle.addEventListener('click', toggleModal);
      closeKanban.addEventListener('click', closeModal);
      kanbanModal.addEventListener('click', handleOutsideClick);
    }
  }

  function toggleModal() {
    const kanbanModal = document.getElementById('kanbanModal');
    kanbanModal.classList.remove('hidden');
    document.body.style.overflow = 'hidden';
  }

  function closeModal() {
    const kanbanModal = document.getElementById('kanbanModal');
    kanbanModal.classList.add('hidden');
    document.body.style.overflow = 'auto';
  }

  function handleOutsideClick(e) {
    if (e.target === document.getElementById('kanbanModal')) {
      closeModal();
    }
  }

  // Initialize on page load
  document.addEventListener('DOMContentLoaded', initializeKanban);

  // Initialize when Astro view transitions complete
  document.addEventListener('astro:page-load', initializeKanban);
</script>